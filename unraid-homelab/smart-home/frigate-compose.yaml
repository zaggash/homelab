services:
  frigate:
    container_name: frigate
    image: ghcr.io/blakeblackshear/frigate:stable
    labels:
      folder.view: Smart-Home
      net.unraid.docker.icon: ${SECRET_APPDATA}/icons/frigate.png
      traefik.enable: true
      traefik.http.routers.frigate-hass.rule: ClientIP(`192.168.1.11`)
      traefik.http.routers.frigate-hass.entryPoints: frigate
      traefik.http.services.frigate-hass.loadbalancer.server.port: 5000
      traefik.http.routers.frigate-hass.service: frigate-hass
      traefik.http.routers.frigate.rule: Host(`frigate.${SECRET_HOME_DOMAIN}`)
      traefik.http.routers.frigate.entryPoints: websecure
      traefik.http.services.frigate.loadbalancer.server.port: 8971
      traefik.http.services.frigate.loadbalancer.server.scheme: https
      traefik.http.routers.frigate.service: frigate
    devices:
      - /dev/dri/renderD128:/dev/dri/renderD128
    shm_size: "64mb"
    volumes:
      - "${SECRET_APPDATA}/frigate/config:/config"
      - "${SECRET_APPDATA}/frigate/media:/media/frigate"
      - type: tmpfs
        target: /tmp/cache
        tmpfs:
          size: 1000000000
    ports:
      - "8554:8554"
      - "8555:8555"
    networks:
      proxy:
    restart: always
